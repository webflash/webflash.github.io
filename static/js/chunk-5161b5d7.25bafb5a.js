(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5161b5d7","chunk-7df574fa","chunk-593eea03","chunk-2d237e88","chunk-2d0b9d1e","chunk-2d216217","chunk-2d226008"],{"1f34":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"block"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{size:"mini",placeholder:"请输入帐号"},model:{value:e.listQuery.account,callback:function(t){e.$set(e.listQuery,"account",t)},expression:"listQuery.account"}})],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{size:"mini",placeholder:"请输入姓名"},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}})],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-search"},nativeOn:{click:function(t){return e.search(t)}}},[e._v(e._s(e.$t("button.search")))]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-refresh"},nativeOn:{click:function(t){return e.reset(t)}}},[e._v(e._s(e.$t("button.reset")))])],1)],1),e._v(" "),r("br"),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/mgr/add"],expression:"['/mgr/add']"}],attrs:{type:"success",size:"mini",icon:"el-icon-plus"},nativeOn:{click:function(t){return e.add(t)}}},[e._v("\n          "+e._s(e.$t("button.add"))+"\n        ")]),e._v(" "),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/mgr/edit"],expression:"['/mgr/edit']"}],attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},nativeOn:{click:function(t){return e.edit(t)}}},[e._v("\n          "+e._s(e.$t("button.edit"))+"\n        ")]),e._v(" "),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["/mgr/delete"],expression:"['/mgr/delete']"}],attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},nativeOn:{click:function(t){return e.remove(t)}}},[e._v("\n          "+e._s(e.$t("button.delete"))+"\n        ")]),e._v(" "),r("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-role"},nativeOn:{click:function(t){return e.openRole(t)}}},[e._v("角色分配")])],1)],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[r("el-table-column",{attrs:{label:"账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.account)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.sexName)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.roleName)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.deptName)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"邮箱"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.email)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"电话"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.phone)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.createTime)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.changeUserStatus(t.row)}},model:{value:1==t.row.status,callback:function(r){e.$set(t.row,"status==1",r)},expression:"scope.row.status==1"}})]}}])})],1),e._v(" "),r("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100,500],"page-size":e.listQuery.limit,total:e.total},on:{"size-change":e.changeSize,"current-change":e.fetchPage,"prev-click":e.fetchPrev,"next-click":e.fetchNext}}),e._v(" "),r("el-dialog",{attrs:{title:e.formTitle,visible:e.formVisible,width:"70%"},on:{"update:visible":function(t){e.formVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px","label-position":"right"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账户",prop:"account"}},[r("el-input",{attrs:{minlength:"1"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{minlength:"1"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"性别"}},[r("el-radio-group",{model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[r("el-radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),r("el-radio",{attrs:{label:2}},[e._v("女")])],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),r("el-col",{directives:[{name:"show",rawName:"v-show",value:e.isAdd,expression:"isAdd"}],attrs:{span:12}},[r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),r("el-col",{directives:[{name:"show",rawName:"v-show",value:e.isAdd,expression:"isAdd"}],attrs:{span:12}},[r("el-form-item",{attrs:{label:"确认密码",prop:"rePassword"}},[r("el-input",{attrs:{type:"password"},model:{value:e.form.rePassword,callback:function(t){e.$set(e.form,"rePassword",t)},expression:"form.rePassword"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"电话",prop:"phone"}},[r("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"所属部门"}},[r("el-input",{attrs:{placeholder:"请选择所属部门",readonly:"readonly"},nativeOn:{click:function(t){e.deptTree.show=!e.deptTree.show}},model:{value:e.form.deptName,callback:function(t){e.$set(e.form,"deptName",t)},expression:"form.deptName"}}),e._v(" "),e.deptTree.show?r("el-tree",{staticClass:"input-tree",attrs:{"empty-text":"暂无数据","expand-on-click-node":!1,data:e.deptTree.data,props:e.deptTree.defaultProps},on:{"node-click":e.handleNodeClick}}):e._e()],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"是否启用",prop:"status"}},[r("el-switch",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"出生日期"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1)],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.saveUser}},[e._v(e._s(e.$t("button.submit")))]),e._v(" "),r("el-button",{nativeOn:{click:function(t){e.formVisible=!1}}},[e._v(e._s(e.$t("button.cancel")))])],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"角色分配",visible:e.roleDialog.visible,width:"25%"},on:{"update:visible":function(t){return e.$set(e.roleDialog,"visible",t)}}},[r("el-form",[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-tree",{ref:"roleTree",attrs:{data:e.roleDialog.roles,"show-checkbox":"","node-key":"id","default-checked-keys":e.roleDialog.checkedRoleKeys,props:e.roleDialog.defaultProps}})],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.setRole}},[e._v(e._s(e.$t("button.submit")))])],1)],1)],1)],1)},s=[],i=r("c0c7"),a=r("fcb7"),o=r("ed08"),l=r("3528"),u=r("4381"),c={directives:{permission:u["default"]},data:function(){return{roleDialog:{visible:!1,roles:[],roleTree:[],checkedRoleKeys:[],defaultProps:{id:"id",label:"name",children:"children"}},formVisible:!1,formTitle:"添加用户",deptTree:{show:!1,data:[],defaultProps:{id:"id",label:"simplename",children:"children"}},isAdd:!0,form:{id:"",account:"",name:"",birthday:"",sex:1,email:"",password:"",rePassword:"",dept:"",status:!0,deptid:1,deptName:""},rules:{account:[{required:!0,message:"请输入登录账号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入email",trigger:"blur"}]},listQuery:{page:1,limit:20,account:void 0,name:void 0},total:0,list:null,listLoading:!0,selRow:{}}},filters:{statusFilter:function(e){var t={published:"success",draft:"gray",deleted:"danger"};return t[e]}},created:function(){this.init()},methods:{init:function(){var e=this;Object(a["list"])().then((function(t){e.deptTree.data=t.data})),this.fetchData()},fetchData:function(){var e=this;this.listLoading=!0,Object(i["getList"])(this.listQuery).then((function(t){e.list=t.data.records,e.listLoading=!1,e.total=t.data.total}))},search:function(){this.fetchData()},reset:function(){this.listQuery.account="",this.listQuery.name="",this.fetchData()},handleFilter:function(){this.listQuery.page=1,this.getList()},handleClose:function(){},fetchNext:function(){this.listQuery.page=this.listQuery.page+1,this.fetchData()},fetchPrev:function(){this.listQuery.page=this.listQuery.page-1,this.fetchData()},fetchPage:function(e){this.listQuery.page=e,this.fetchData()},changeSize:function(e){this.listQuery.limit=e,this.fetchData()},handleCurrentChange:function(e,t){this.selRow=e},resetForm:function(){this.form={id:"",account:"",name:"",birthday:"",sex:1,email:"",password:"",rePassword:"",dept:"",status:!0,deptid:1}},add:function(){this.resetForm(),this.formTitle="添加用户",this.formVisible=!0,this.isAdd=!0},changeUserStatus:function(e){var t=this;Object(i["changeStatus"])(e.id).then((function(e){t.$message({message:"提交成功",type:"success"}),t.fetchData()}))},validPasswd:function(){return!this.isAdd||this.form.password===this.form.rePassword&&(""!==this.form.password&&""!==this.form.rePassword)},saveUser:function(){var e=this,t=this;this.$refs["form"].validate((function(r){if(!r)return console.log("error submit!!"),!1;if(e.validPasswd()){var n=t.form;!0===n.status?n.status=1:n.status=2,n.birthday=Object(o["parseTime"])(n.birthday,"{y}-{m}-{d}"),n.createtime=Object(o["parseTime"])(n.createtime),Object(i["saveUser"])(n).then((function(t){e.$message({message:"提交成功",type:"success"}),e.fetchData(),e.formVisible=!1}))}else e.$message({message:"提交失败",type:"error"})}))},checkSel:function(){return!(!this.selRow||!this.selRow.id)||(this.$message({message:"请选中操作项",type:"warning"}),!1)},edit:function(){this.checkSel()&&(this.isAdd=!1,this.form=this.selRow,this.form.status="启用"===this.selRow.statusName,this.form.password="",this.formTitle="修改用户",this.formVisible=!0)},remove:function(){var e=this;if(this.checkSel()){var t=this.selRow.id;this.$confirm("确定删除该记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["remove"])(t).then((function(t){e.$message({message:"删除成功",type:"success"}),e.fetchData()})).catch((function(t){e.$notify.error({title:"错误",message:t})}))})).catch((function(){}))}},handleNodeClick:function(e,t){this.form.deptid=e.id,this.form.deptName=e.simplename,this.deptTree.show=!1},openRole:function(){var e=this;this.checkSel()&&Object(l["roleTreeListByIdUser"])(this.selRow.id).then((function(t){e.roleDialog.roles=t.data.treeData,e.roleDialog.checkedRoleKeys=t.data.checkedIds,e.roleDialog.visible=!0}))},setRole:function(){var e=this,t=this.$refs.roleTree.getCheckedKeys(),r="";for(var n in t)r+=t[n]+",";var s={userId:this.selRow.id,roleIds:r};Object(i["setRole"])(s).then((function(t){e.roleDialog.visible=!1,e.fetchData(),e.$message({message:"提交成功",type:"success"})}))}}},d=c,f=(r("d983"),r("2877")),m=Object(f["a"])(d,n,s,!1,null,"6aabd078",null);t["default"]=m.exports},"28a5":function(e,t,r){"use strict";var n=r("aae3"),s=r("cb7c"),i=r("ebd6"),a=r("0390"),o=r("9def"),l=r("5f1b"),u=r("520a"),c=r("79e5"),d=Math.min,f=[].push,m="split",p="length",h="lastIndex",v=4294967295,b=!c((function(){RegExp(v,"y")}));r("214f")("split",2,(function(e,t,r,c){var g;return g="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[p]||2!="ab"[m](/(?:ab)*/)[p]||4!="."[m](/(.?)(.?)/)[p]||"."[m](/()()/)[p]>1||""[m](/.?/)[p]?function(e,t){var s=String(this);if(void 0===e&&0===t)return[];if(!n(e))return r.call(s,e,t);var i,a,o,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,m=void 0===t?v:t>>>0,b=new RegExp(e.source,c+"g");while(i=u.call(b,s)){if(a=b[h],a>d&&(l.push(s.slice(d,i.index)),i[p]>1&&i.index<s[p]&&f.apply(l,i.slice(1)),o=i[0][p],d=a,l[p]>=m))break;b[h]===i.index&&b[h]++}return d===s[p]?!o&&b.test("")||l.push(""):l.push(s.slice(d)),l[p]>m?l.slice(0,m):l}:"0"[m](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,n){var s=e(this),i=void 0==r?void 0:r[t];return void 0!==i?i.call(r,s,n):g.call(String(s),r,n)},function(e,t){var n=c(g,e,this,t,g!==r);if(n.done)return n.value;var u=s(e),f=String(this),m=i(u,RegExp),p=u.unicode,h=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(b?"y":"g"),y=new m(b?u:"^(?:"+u.source+")",h),w=void 0===t?v:t>>>0;if(0===w)return[];if(0===f.length)return null===l(y,f)?[f]:[];var _=0,k=0,x=[];while(k<f.length){y.lastIndex=b?k:0;var O,$=l(y,b?f:f.slice(k));if(null===$||(O=d(o(y.lastIndex+(b?0:k)),f.length))===_)k=a(f,k,p);else{if(x.push(f.slice(_,k)),x.length===w)return x;for(var D=1;D<=$.length-1;D++)if(x.push($[D]),x.length===w)return x;k=_=O}}return x.push(f.slice(_)),x}]}))},3528:function(e,t,r){"use strict";r.r(t),r.d(t,"getList",(function(){return s})),r.d(t,"save",(function(){return i})),r.d(t,"remove",(function(){return a})),r.d(t,"roleTreeListByIdUser",(function(){return o})),r.d(t,"savePermissons",(function(){return l}));var n=r("b775");function s(e){return Object(n["default"])({url:"/role/list",method:"get",params:e})}function i(e){return Object(n["default"])({url:"/role",method:"post",params:e})}function a(e){return Object(n["default"])({url:"/role",method:"delete",params:{roleId:e}})}function o(e){return Object(n["default"])({url:"/role/roleTreeListByIdUser",method:"get",params:{idUser:e}})}function l(e){return Object(n["default"])({url:"/role/savePermisson",method:"post",params:e})}},3846:function(e,t,r){r("9e1e")&&"g"!=/./g.flags&&r("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:r("0bfb")})},4381:function(e,t,r){"use strict";r.r(t);var n=r("e799"),s=function(e){e.directive("permission",n["default"])};window.Vue&&(window["permission"]=n["default"],Vue.use(s)),n["default"].install=s,t["default"]=n["default"]},"6b16":function(e,t,r){},"6b54":function(e,t,r){"use strict";r("3846");var n=r("cb7c"),s=r("0bfb"),i=r("9e1e"),a="toString",o=/./[a],l=function(e){r("2aba")(RegExp.prototype,a,e,!0)};r("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?l((function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!i&&e instanceof RegExp?s.call(e):void 0)})):o.name!=a&&l((function(){return o.call(this)}))},c0c7:function(e,t,r){"use strict";r.r(t),r.d(t,"getList",(function(){return s})),r.d(t,"saveUser",(function(){return i})),r.d(t,"remove",(function(){return a})),r.d(t,"setRole",(function(){return o})),r.d(t,"changeStatus",(function(){return l}));var n=r("b775");function s(e){return Object(n["default"])({url:"/user/list",method:"get",params:e})}function i(e){return Object(n["default"])({url:"/user",method:"post",params:e})}function a(e){return Object(n["default"])({url:"/user",method:"delete",params:{userId:e}})}function o(e){return Object(n["default"])({url:"/user/setRole",method:"get",params:e})}function l(e){return Object(n["default"])({url:"/user/changeStatus",method:"get",params:{userId:e}})}},d983:function(e,t,r){"use strict";var n=r("6b16"),s=r.n(n);s.a},e799:function(e,t,r){"use strict";r.r(t);r("6762"),r("2fdb");var n=r("4360");t["default"]={inserted:function(e,t,r){var s=t.value,i=n["default"].getters&&n["default"].getters.permissions;if(!(s&&s instanceof Array&&s.length>0))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");var a=s,o=i.some((function(e){return a.includes(e)}));o||e.parentNode&&e.parentNode.removeChild(e)}}},ed08:function(e,t,r){"use strict";r.r(t);r("28a5"),r("a481"),r("6b54");var n=r("5d58"),s=r.n(n),i=r("67bb"),a=r.n(i);function o(e){return o="function"===typeof a.a&&"symbol"===typeof s.a?function(e){return typeof e}:function(e){return e&&"function"===typeof a.a&&e.constructor===a.a&&e!==a.a.prototype?"symbol":typeof e},o(e)}function l(e,t){if(0===arguments.length)return null;var r,n=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===o(e)?r=e:("string"===typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"===typeof e&&10===e.toString().length&&(e*=1e3),r=new Date(e));var s={y:r.getFullYear(),m:r.getMonth()+1,d:r.getDate(),h:r.getHours(),i:r.getMinutes(),s:r.getSeconds(),a:r.getDay()},i=n.replace(/{(y|m|d|h|i|s|a)+}/g,(function(e,t){var r=s[t];return"a"===t?["日","一","二","三","四","五","六"][r]:(e.length>0&&r<10&&(r="0"+r),r||0)}));return i}function u(e,t){e=10===(""+e).length?1e3*parseInt(e):+e;var r=new Date(e),n=Date.now(),s=(n-r)/1e3;return s<30?"刚刚":s<3600?Math.ceil(s/60)+"分钟前":s<86400?Math.ceil(s/3600)+"小时前":s<172800?"1天前":t?l(e,t):r.getMonth()+1+"月"+r.getDate()+"日"+r.getHours()+"时"+r.getMinutes()+"分"}function c(e){var t=e.split("?")[1];return t?JSON.parse('{"'+decodeURIComponent(t).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"').replace(/\+/g," ")+'"}'):{}}r.d(t,"parseTime",(function(){return l})),r.d(t,"formatTime",(function(){return u})),r.d(t,"param2Obj",(function(){return c}))},fcb7:function(e,t,r){"use strict";r.r(t),r.d(t,"tree",(function(){return s})),r.d(t,"list",(function(){return i})),r.d(t,"save",(function(){return a})),r.d(t,"del",(function(){return o}));var n=r("b775");function s(){return Object(n["default"])({url:"/dept/tree",method:"get"})}function i(){return Object(n["default"])({url:"/dept/list",method:"get"})}function a(e){return Object(n["default"])({url:"/dept",method:"post",params:e})}function o(e){return Object(n["default"])({url:"/dept",method:"delete",params:{id:e}})}}}]);