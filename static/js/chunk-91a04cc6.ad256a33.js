(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-91a04cc6","chunk-2d237e88","chunk-2d0b9d1e"],{1280:function(e,t,i){},3528:function(e,t,i){"use strict";i.r(t),i.d(t,"getList",(function(){return s})),i.d(t,"save",(function(){return r})),i.d(t,"remove",(function(){return o})),i.d(t,"roleTreeListByIdUser",(function(){return a})),i.d(t,"savePermissons",(function(){return l}));var n=i("b775");function s(e){return Object(n["default"])({url:"/role/list",method:"get",params:e})}function r(e){return Object(n["default"])({url:"/role",method:"post",params:e})}function o(e){return Object(n["default"])({url:"/role",method:"delete",params:{roleId:e}})}function a(e){return Object(n["default"])({url:"/role/roleTreeListByIdUser",method:"get",params:{idUser:e}})}function l(e){return Object(n["default"])({url:"/role/savePermisson",method:"post",params:e})}},"70eb":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"block"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("el-input",{attrs:{size:"mini",placeholder:"请输入角色名称"},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}})],1),e._v(" "),i("el-col",{attrs:{span:6}},[i("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-search"},nativeOn:{click:function(t){return e.search(t)}}},[e._v(e._s(e.$t("button.search")))]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-refresh"},nativeOn:{click:function(t){return e.reset(t)}}},[e._v(e._s(e.$t("button.reset")))])],1)],1),e._v(" "),i("br"),e._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-plus"},nativeOn:{click:function(t){return e.add(t)}}},[e._v(e._s(e.$t("button.add")))]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},nativeOn:{click:function(t){return e.edit(t)}}},[e._v(e._s(e.$t("button.edit")))]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},nativeOn:{click:function(t){return e.remove(t)}}},[e._v(e._s(e.$t("button.delete")))]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-setting"},nativeOn:{click:function(t){return e.openPermissions(t)}}},[e._v("权限配置")])],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[i("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"编码"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.tips)+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"所在部门"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.deptName)+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"上级角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.pName)+"\n      ")]}}])})],1),e._v(" "),i("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100,500],"page-size":e.listQuery.limit,total:e.total},on:{"size-change":e.changeSize,"current-change":e.fetchPage,"prev-click":e.fetchPrev,"next-click":e.fetchNext}}),e._v(" "),i("el-dialog",{attrs:{title:e.formTitle,visible:e.formVisible,width:"70%"},on:{"update:visible":function(t){e.formVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"编码",prop:"tips"}},[i("el-input",{attrs:{minlength:"1"},model:{value:e.form.tips,callback:function(t){e.$set(e.form,"tips",t)},expression:"form.tips"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"名称",prop:"name"}},[i("el-input",{attrs:{minlength:"1"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"上级角色"}},[i("el-input",{attrs:{placeholder:"请选择上级角色",readonly:"readonly"},nativeOn:{click:function(t){e.roleTree.show=!e.roleTree.show}},model:{value:e.form.pName,callback:function(t){e.$set(e.form,"pName",t)},expression:"form.pName"}}),e._v(" "),e.roleTree.show?i("el-tree",{staticClass:"input-tree",attrs:{"empty-text":"暂无数据","expand-on-click-node":!1,data:e.list,props:e.roleTree.defaultProps},on:{"node-click":e.handleRoleNodeClick}}):e._e()],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"排序"}},[i("el-input",{attrs:{type:"number"},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"所在部门"}},[i("el-input",{attrs:{placeholder:"请选择所在部门",readonly:"readonly"},nativeOn:{click:function(t){e.deptTree.show=!e.deptTree.show}},model:{value:e.form.deptName,callback:function(t){e.$set(e.form,"deptName",t)},expression:"form.deptName"}}),e._v(" "),e.deptTree.show?i("el-tree",{staticClass:"input-tree",attrs:{"empty-text":"暂无数据","expand-on-click-node":!1,data:e.deptList,props:e.deptTree.defaultProps},on:{"node-click":e.handleDeptNodeClick}}):e._e()],1)],1)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("button.submit")))]),e._v(" "),i("el-button",{nativeOn:{click:function(t){e.formVisible=!1}}},[e._v(e._s(e.$t("button.cancel")))])],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"权限配置",visible:e.permissonVisible,width:"25%"},on:{"update:visible":function(t){e.permissonVisible=t}}},[i("el-form",[i("el-row",[i("el-col",{attrs:{span:12}},[i("el-tree",{ref:"permissonTree",attrs:{data:e.permissons,"show-checkbox":"","node-key":"id","default-checked-keys":e.checkedPermissionKeys,props:e.defaultProps}})],1)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.savePermissions}},[e._v(e._s(e.$t("button.submit")))])],1)],1)],1)],1)},s=[],r=(i("7f7f"),i("3528")),o=i("fcb7"),a=i("a6dc"),l={data:function(){return{formVisible:!1,formTitle:"添加角色",deptList:[],roleList:[],isAdd:!0,checkedPermissionKeys:[],permissons:[],defaultProps:{id:"id",label:"name",children:"children"},permissonVisible:!1,deptTree:{show:!1,defaultProps:{id:"id",label:"simplename",children:"children"}},roleTree:{show:!1,defaultProps:{id:"id",label:"name",children:"children"}},form:{tips:"",name:"",deptid:"",pid:0,id:"",version:"",deptName:"",pName:"",num:1},rules:{tips:[{required:!0,message:"请输入角色编码",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}]},listQuery:{name:void 0},total:0,list:null,listLoading:!0,selRow:{}}},filters:{statusFilter:function(e){var t={published:"success",draft:"gray",deleted:"danger"};return t[e]}},created:function(){this.init()},methods:{init:function(){var e=this;Object(o["list"])().then((function(t){e.deptList=t.data})),this.fetchData()},fetchData:function(){var e=this;this.listLoading=!0,Object(r["getList"])(this.listQuery).then((function(t){console.log(t.data),e.list=t.data,e.listLoading=!1,e.total=t.data.total}))},search:function(){this.fetchData()},reset:function(){this.listQuery.name="",this.fetchData()},handleFilter:function(){this.getList()},fetchNext:function(){this.listQuery.page=this.listQuery.page+1,this.fetchData()},fetchPrev:function(){this.listQuery.page=this.listQuery.page-1,this.fetchData()},fetchPage:function(e){this.listQuery.page=e,this.fetchData()},changeSize:function(e){this.listQuery.limit=e,this.fetchData()},handleCurrentChange:function(e,t){this.selRow=e},resetForm:function(){this.form={tips:"",name:"",deptid:"",pid:0,id:"",version:"",deptName:"",pName:"",num:1}},add:function(){this.resetForm(),this.formTitle="添加角色",this.formVisible=!0,this.isAdd=!0},save:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return console.log("error submit!!"),!1;Object(r["save"])({id:e.form.id,num:e.form.num,deptid:e.form.deptid,pid:e.form.pid,name:e.form.name,tips:e.form.tips}).then((function(t){e.$message({message:"提交成功",type:"success"}),e.fetchData(),e.formVisible=!1}))}))},checkSel:function(){return!(!this.selRow||!this.selRow.id)||(this.$message({message:"请选中操作项",type:"warning"}),!1)},edit:function(){this.checkSel()&&(this.isAdd=!1,this.form=this.selRow,this.form.status="启用"===this.selRow.statusName,this.form.password="",this.formTitle="修改角色",this.formVisible=!0)},remove:function(){var e=this;if(this.checkSel()){var t=this.selRow.id;this.$confirm("确定删除该记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["remove"])(t).then((function(t){e.$message({message:"提交成功",type:"success"}),e.fetchData()})).catch((function(t){e.$notify.error({title:"错误",message:t})}))})).catch((function(){}))}},openPermissions:function(){var e=this;this.checkSel()&&Object(a["menuTreeListByRoleId"])(this.selRow.id).then((function(t){e.permissons=t.data.treeData,e.checkedPermissionKeys=t.data.checkedIds,e.permissonVisible=!0}))},savePermissions:function(){var e=this,t=this.$refs.permissonTree.getCheckedNodes(!1,!0),i="";for(var n in t)i+=t[n].id+",";var s={roleId:this.selRow.id,permissions:i};Object(r["savePermissons"])(s).then((function(t){e.permissonVisible=!1,e.$message({message:"提交成功",type:"success"})}))},handleDeptNodeClick:function(e,t){this.form.deptid=e.id,this.form.deptName=e.simplename,this.deptTree.show=!1},handleRoleNodeClick:function(e,t){this.form.pid=e.id,this.form.pName=e.name,this.roleTree.show=!1}}},c=l,u=(i("8243"),i("2877")),d=Object(u["a"])(c,n,s,!1,null,"b7d0110a",null);t["default"]=d.exports},8243:function(e,t,i){"use strict";var n=i("1280"),s=i.n(n);s.a},fcb7:function(e,t,i){"use strict";i.r(t),i.d(t,"tree",(function(){return s})),i.d(t,"list",(function(){return r})),i.d(t,"save",(function(){return o})),i.d(t,"del",(function(){return a}));var n=i("b775");function s(){return Object(n["default"])({url:"/dept/tree",method:"get"})}function r(){return Object(n["default"])({url:"/dept/list",method:"get"})}function o(e){return Object(n["default"])({url:"/dept",method:"post",params:e})}function a(e){return Object(n["default"])({url:"/dept",method:"delete",params:{id:e}})}}}]);